这是一份 **MVP 项目接口规范文档**，供全员查阅。

# 陪伴学习软件 MVP 接口与协作规范手册

## 1. 架构说明：逻辑中枢模式

本项目采用**“中枢广播”**架构。由**组员 C** 维护的 `app_controller.dart` 作为 App 的“大脑”，通过 `ValueNotifier` 向外发送状态，**组员 B 和 D** 负责接收信号并更新视觉表现。

### 协作拓扑图

- **组员 A (组长整合)**：负责 `main.dart` 中的 `Stack` 布局整合。
- **组员 B (图形引擎)**：监听状态并控制角色动作切换。
- **组员 C (逻辑中枢)**：管理计时器、数据存储与状态广播。
- **组员 D (前端交互)**：监听状态并更新 UI 面板与统计图表。

------

## 2. 状态广播接口 (ValueNotifier)

组员 B 和 D 需通过 `ValueListenableBuilder` 订阅以下变量，**禁止**在 View 层直接修改这些值。

| 变量名             | 类型     | 描述                               | 使用者                                |
| ------------------ | -------- | ---------------------------------- | ------------------------------------- |
| `remainingSeconds` | `int`    | **倒计时秒数**：默认 1500 秒       | 组员 D (进度条/数字)                  |
| `isActive`         | `bool`   | **运行状态**：是否正在计时         | 组员 B (动画切换) / 组员 D (按钮文本) |
| `isDrawerOpen`     | `bool`   | **菜单状态**：统计面板是否弹出     | 组员 A (布局调整)                     |
| `currentDate`      | `String` | **格式化日期**：如 "2026年1月13日" | 组员 D (顶部显示)                     |

------

## 3. 逻辑触发接口 (Methods)

当用户发生点击行为时，组员 D 应通过构造函数调用组员 C 提供的以下方法：

- **`toggleTimer()`**: 切换计时器的开始与暂停。
- **`resetTimer()`**: 重置番茄钟至初始状态。
- **`fetchHistoryData()`**: 从本地存储（Storage）读取历史时长，触发 UI 数据更新。

------

## 4. 资源路径规范

为了确保代码能正确加载文件，资源必须存放在项目根目录的 `assets/` 文件夹下并在 `pubspec.yaml` 中注册。

- **背景图**：`assets/background.webp` (横屏)
- **Live2D 模型**：`assets/character/model.model3.json` *(待补充)*
- **占位图**：`assets/Placeholder.png` *(待补充)*
